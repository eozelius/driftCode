<div id="view-driftmap-wizard">

<button class="toggle-wizard normal"><i class="fa fa-tachometer"></i></button>

<div class="wizard-container">
  <ul class="tabs-menu">
    <li data-step="todo" class="wizard-table active-tab">all</li>
    <li data-step="routes" class="wizard-table" style="font-size:.88em;">journeys</li>
    <li data-step="markers" class="wizard-table"></i>blips</li>
  </ul>

  <div class="driftmap-form-container">
    <div class="todo-step-container wizard-step">
      <div class="wizard-todo">
        <p class="instructions-title" style="color: #552727">all my blips and journeys</p>
        <button class="todo normal">reveal</button>
      </div>
    </div>

   	<!-- routes -->
    <div class="routes-container wizard-step hidden">
      <div class="wizard-routes">
        <ul>
          <% @post.routes.each_with_index do |route, i| %>
            <li class="route">
              <p class="route-title" data-route="<%= route.id %>" data-initx="<%= route.route_points.first.x %>" data-inity="<%= route.route_points.first.y %>">
                <%= route.title %>
              </p>

              <div class="route-info" data-route="<%= route.id %>" style="display:none;">
                <p class="route-body" data-route="<%= route.id %>">
                  <%= route.description %>
                </p>
              </div>
            </li>
          <% end %>
        </ul>
      </div>
    </div>
    
    <!-- blips -->
    <div class="markers-container wizard-step hidden">
      <div class="wizard-markers">
        <p class="instructions-title">a blip is a moment in time on your map.  It can be a park, a tour, cafe, experience or anything you would like it to be.  you may give your radar blip(s) names, descriptions and image galleries.</p>
      </div>
    </div>
  </div>

  <div class="todo-container hidden">

  </div>
</div>
</div>

<script type="text/javascript">
  $(function(){
    // toggle wizard
    $('.toggle-wizard').on('click', function(){
      if($('.wizard-container').hasClass('active')){
        $('.wizard-container').removeClass('active');
      } else {
        $('.wizard-container').addClass('active');
      }
    });

    // Change menu tab
    $('.tabs-menu li').on('click', function(){
      $('.active-tab').removeClass('active-tab');
      var tab = $(this).data('step');
      $(this).addClass('active-tab');

      $('.wizard-step').addClass('hidden');
      $('.'+ tab + '-container').removeClass('hidden');    
    });

    // reveal Route info
    $('.route-title').on('click', function(){
      active = $(this).hasClass('active');
      route_index = $(this).data('route');

      if(active){
        $('.route-info[data-route="'+ route_index +'"]').slideUp(700);
        $(this).removeClass('active');
      } else {
        $('.route-info[data-route="'+ route_index +'"]').slideDown(700);
        $(this).addClass('active');
        var init_x = $(this).data('initx') - 0.5;
        var init_y = $(this).data('inity') - 2.2;
        window.map.setZoomAround([init_x, init_y], 7);
      }
    });

    // reveal all journey and blips data
    $('.todo').on('click', function(){
      $('.wizard-container').addClass('reveal-all');
      $('#map').css('top','-489px');
      $('.tabs-menu, .todo-container, .wizard-todo').toggleClass('hidden');
    });
  });
</script>