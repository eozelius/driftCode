<div class="container">
	<div id="dm-content-container" class="col-lg-8 col-md-8 col-sm-8 col-xs-12">
		<div class="blip-content">
			<!-- blip carousel -->
			<div id="images-carousel" class="carousel slide" data-ride="carousel">

				<!-- Blip Photos -->
				<div class="carousel-inner" role="listbox">
				  <% @blip.blip_images.each_with_index do |image, i| %>
				    <div class="item <%= 'active' if i == 0 %>">
				      <%= image_tag image.image %>
				    </div>
				  <% end %>
				</div>

				<% if @blip.blip_images.count > 1 %>
				  <!-- Indicators -->
				  <ol class="carousel-indicators">
				    <% @blip.blip_images.count.times do |b| %>
				      <li data-target="#images-carousel" data-slide-to="<%= b %>"></li>
				    <% end %>
				    <script type="text/javascript">
				      $('li[data-target="#images-carousel"]').first().addClass('active')
				    </script>
				  </ol>

				  <!-- Controls -->
				  <a class="left carousel-control" href="#images-carousel" role="button" data-slide="prev">
				    <i class="fa fa-angle-left fa-3x" aria-hidden="true"></i>
				    <span class="sr-only">Previous</span>
				  </a>
				  <a class="right carousel-control" href="#images-carousel" role="button" data-slide="next">
				    <i class="fa fa-angle-right fa-3x" aria-hidden="true"></i>
				    <span class="sr-only">Next</span>
				  </a>
				<% end %>
			</div>

			<!-- blip author title text  -->
			<div class="blip-info" >
			  <h4 class="blip-title">
			    <%= @blip.title %>
			  </h4>

			  <p class="blip-body">
			    <%= @blip.body %>
			  </p>
			</div>
		</div>
	</div>

	<div id="dm-legend" class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
		<div class="map-container">
		  <div id='map'></div>

		  <script type="text/javascript">
		    var driftmap = {
		      init_x: '<%= @blip.x %>',
		      init_y: '<%= @blip.y %>',
		      init_zoom: 7,
		    }

		    var blips = [];
		    var blipImages = [];

		    <% @blip.blip_images.each do |blip_image| %>
		      blipImages.push('<%= image_tag(blip_image.image).html_safe %>');
		    <% end %>

		    blips.push({
		      id:     "<%= @blip.id %>",
		      x:      "<%= @blip.x %>",
		      y:      "<%= @blip.y %>",
		      title:  "<%= @blip.title.to_json %>",
		      body:   "<%= @blip.body.to_json %>",
		      images: blipImages
		    });

		    init_map('map', driftmap, blips);
	    </script>
		</div>
	</div>
</div>

<style type="text/css">
	.map-container {
		top: 0;
	}
</style>